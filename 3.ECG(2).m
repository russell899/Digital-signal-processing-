%在notch滤波器的设计中，虽然极点会在某些频率处产生放大作用，但它们的位置需要与零点互相配合，以 增强对目标频率的抑制效果。当极点离单位圆稍近时，它们帮助产生对目标频率的 带阻效应，即尽量减少该频率的影响。
%选择极点靠近单位圆，不会放大不必要的频率成分，反而会与零点共同作用增强带阻效应
%假设极点半径为0.95

% 干扰频率（60 Hz, 120 Hz, 180 Hz）
f_interference = [60, 120, 180];  % 干扰频率
fs = 600;  % 采样频率（600 Hz）

% 极点半径（选择在 0.9 到 0.99 之间）
pole_radius = 0.95;

% 初始化零点和极点
z = [];  % 存储零点
p = [];  % 存储极点

% 对每个干扰频率进行处理
for i = 1:length(f_interference)
    % 计算对应干扰频率的角度
    theta = 2 * pi * f_interference(i) / fs;
    
    % 计算零点位置（干扰频率的共轭复数）
    z1 = exp(1j * theta);  % 零点
    z2 = conj(z1);         % 共轭零点
    z = [z; z1; z2];       % 将零点添加到零点数组
    
    % 计算极点位置（相同角度但半径为 0.95）
    p1 = pole_radius * exp(1j * theta);  % 极点位置，半径为 0.95
    p2 = conj(p1);                        % 共轭极点
    p = [p, p1, p2];                      % 将极点添加到极点数组
end

% 使用 zp2tf 函数将零极点转换为传递函数
[b, a] = zp2tf(z, p, 1);  % 1 是增益因子（默认）

% 显示传递函数系数
disp('分子系数 (b):');
disp(b);
disp('分母系数 (a):');
disp(a);

%画出它的零点与极点图
figure;
zplane(b, a);
title('Pole-Zero Plot');

% 绘制频率响应
fvtool(b, a, 'Fs', fs);  % 绘制频率响应图
